# Ai4Energy 开发计划

## 总纲

### 项目背景
随着全球面临气候变化、能源安全等一系列重大挑战，绿色低碳发展成为各国政府和社会各界共同关注的重点。能源系统作为现代社会的基础设施，肩负着推动可持续发展和减排目标的重任。而当前能源生产和消费模式正处于深刻变革之中，能源生产、转换、传输和消费的智能化、数字化成为行业发展的必然趋势。

综合能源系统（Integrated Energy System, IES）作为推动能源行业向低碳、绿色发展的核心方向，要求能源的各个子系统（如电力、热力、天然气和可再生能源等）进行深度的整合与协同，以提升系统的整体效率和可持续性。在这一过程中，能源系统的优化设计与运行、资源的高效调度成为关键要素。

### 发展趋势
绿色低碳转型的需要：全球范围内对减少温室气体排放的需求日益加剧，尤其在《巴黎协议》的背景下，各国政府不断制定更为严格的减排目标。这要求能源系统不仅要提高效率，还要减少对传统化石能源的依赖，推动可再生能源的大规模接入。

数字化、智能化发展：随着信息技术、数据分析和人工智能的飞速发展，能源系统的数字化与智能化已成为不可逆转的趋势。通过智能感知、数据驱动、AI优化，能源系统可以实现更高效、更灵活的调度和管理。

系统优化与控制的重要性：综合能源系统的运行效率、成本效益及环境影响在很大程度上依赖于系统设计与实时优化。在这一背景下，系统建模、仿真、优化与控制成为实现绿色低碳转型的关键技术。

### 项目使命
AI4energy项目旨在提供一整套综合能源系统的开发方法、工具和平台，致力于推动能源系统的数字化、智能化与优化运行。通过先进的AI技术和算法模型，协助能源系统从设计到运行的全生命周期管理，帮助能源行业实现绿色低碳转型。

### 项目目标
开发综合能源系统的建模和仿真工具：提供高效、精准的建模与仿真工具，支持多种能源形式（如电力、热力、天然气、可再生能源）的整合，模拟复杂的系统运行情况。

提供系统优化与控制方法：基于数据驱动的AI优化算法，为能源系统的设计和实时运行提供优化方案，提升系统的整体效率、稳定性和灵活性。

构建平台化服务：开发一个综合能源系统优化与调度平台，能够集成建模、仿真、优化与控制等功能，为用户提供可操作、易用的工具和服务，支持各种规模的能源系统应用。

服务行业需求：针对能源行业不同领域的需求，提供定制化的解决方案，助力政策制定者、能源企业、研究机构和高校在能源系统的绿色低碳发展过程中取得实质性进展。

### 核心技术方向
能源系统建模与仿真：通过先进的数学模型和数据驱动方法，支持复杂的多能互补、动态优化的建模与仿真，准确预测和分析能源系统的运行性能。

系统优化算法与控制策略：采用基于深度学习、强化学习、优化理论等方法的智能算法，实时优化能源生产与消费的调度，实现负荷平衡、节能减排等目标。

大数据与人工智能技术应用：集成传感器数据、智能设备、云计算平台等技术，通过数据分析与AI技术提升系统的预判、决策与控制能力。

## 功能需求

### 设计优化

设计优化功能主要用于能源系统设计阶段，目标是通过数据和模型的支持，帮助工程师在系统设计过程中进行更加精准和高效的决策。具体包括以下几项功能需求：

1. **正向仿真 (Forward Simulation)**  
   - **功能**：通过仿真模型进行系统设计的性能评估，模拟不同方案的运行情况，以便对比分析最优设计方案。
   - **需求**：
     - 支持多种能源子系统（电力、热力、可再生能源等）的联动仿真。
     - 提供实时数据采集和状态反馈，确保仿真结果的准确性和及时性。
     - 模拟不同环境和负荷条件下的系统响应，评估设计的鲁棒性。

2. **容量配置优化 (Capacity Configuration Optimization)**  
   - **功能**：基于仿真结果，优化能源系统各个组件的容量配置，包括发电、储能、负荷管理等，确保在满足需求的前提下，能够最大限度地减少成本和能耗。
   - **需求**：
     - 基于用户输入的需求（如总负荷、可再生能源比例等），自动计算最优的容量配置。
     - 支持多目标优化，包括经济性、环境影响、系统可靠性等。
     - 提供可视化界面，便于用户直观地调整和对比不同配置方案。

3. **灵活性与扩展性**  
   - **功能**：设计阶段需要考虑系统未来可能的扩展性，因此需要提供灵活的扩展功能，以应对未来负荷增长或技术更新。
   - **需求**：
     - 支持模块化设计，能够根据需求动态增减模块或设备。
     - 能够与新的能源技术（如氢能、先进储能技术等）兼容，便于未来升级。

### 运行优化

运行优化功能主要应用于能源系统的实际运行阶段，目的是通过智能化控制和优化算法，确保系统在运行中的高效、经济、绿色运作。具体功能需求包括：

1. **系统寻优 (System Optimization)**  
   - **功能**：实时监控系统运行状态，通过优化算法寻找最佳运行状态，包括负荷调度、发电调度等，以实现最优的能源流动和分配。
   - **需求**：
     - 支持多目标优化，如最小化运行成本、减少排放、提高系统可靠性等。
     - 能够处理大规模的数据集，支持复杂的多变量优化问题。
     - 优化决策需要实时更新，能够响应突发事件（如负荷波动、设备故障等）并进行动态调整。

2. **能源管理与调度 (Energy Management and Dispatching)**  
   - **功能**：通过智能化调度算法，根据实时数据、预测负荷和能源供应情况，优化能源的分配和调度，确保系统的稳定性和经济性。
   - **需求**：
     - 支持不同类型的能源调度（如电力调度、热力调度、天然气调度等）。
     - 提供实时的负荷预测与优化调度功能，确保系统在最优状态下运行。
     - 集成储能系统，支持储能的调度与优化管理。

3. **智能控制与自动化 (Intelligent Control and Automation)**  
   - **功能**：在系统运行过程中，利用智能控制技术自动调整系统运行参数，优化运行效率，避免人为干预。
   - **需求**：
     - 自动调节发电机组、储能设备等的运行状态，确保系统负荷与发电之间的平衡。
     - 支持基于机器学习的预测和控制，能够根据历史数据和实时信息进行动态调整。
     - 提供报警和预警功能，及时发现潜在问题并采取措施，防止系统故障。

4. **排放与能源消耗监控 (Emissions and Energy Consumption Monitoring)**  
   - **功能**：实时监控能源消耗和排放情况，确保系统运行符合环保法规和绿色低碳目标。
   - **需求**：
     - 提供系统整体和各个组件的能耗监测功能，帮助用户实时查看能源消耗和排放水平。
     - 提供碳排放数据分析和报告，支持绿色认证与政策合规性。
     - 支持根据排放目标和能源消耗优化运行策略。

5. **维护与故障诊断 (Maintenance and Fault Diagnosis)**  
   - **功能**：支持系统的健康监测和故障诊断，及时发现和修复潜在问题，减少系统停机时间，提高系统可靠性。
   - **需求**：
     - 实时监测系统运行状态和设备健康，进行故障预测和诊断。
     - 提供维护建议和自动化修复功能，确保系统高效运行。
     - 支持设备故障的远程诊断和问题排查。

## 技术架构

### 总体架构设计

项目采用**云服务架构**，目标是实现高效的资源管理、灵活的扩展性和易于维护的系统结构。整个系统基于松耦合设计，分为**前端**、**后端**、**计算引擎**等多个模块，确保各个模块可以独立开发和部署，同时可以通过接口打通，协同工作。

- **云服务架构**：支持高可用、高弹性的云端部署，保证系统的稳定性和扩展性。
- **松耦合设计**：各模块间尽量减少依赖，确保系统具有更好的灵活性，便于后续功能的扩展和维护。
- **容器化 (Containerization)**：使用容器技术（如 Docker 和 Kubernetes）将各个模块进行隔离和打包，便于分布式部署和跨平台的迁移。

### 技术选型与模块设计

- **前端 (Frontend)**
  - **框架**：Vue.js  
    - 选择Vue.js作为前端开发框架，具有较高的灵活性和可维护性，支持单页面应用（SPA）模式，用户界面响应迅速，易于与后端API进行集成。
    - **功能**：主要负责用户界面的交互、数据展示、模型输入输出等。为设计优化和运行优化提供图形化界面，便于用户进行操作和结果分析。
    - **集成**：与后端通过RESTful API进行数据交互，确保数据传输的高效性。

- **后端 (Backend)**
  - **框架**：Go-zero
    - **Go-zero**作为高性能、轻量级的后端开发框架，适合处理大量并发请求，能高效地支持系统的核心功能。
    - **功能**：后端负责处理前端请求，进行数据处理、权限管理、任务调度等。特别是对于设计优化和运行优化任务的调度和执行，将调用计算引擎进行高效计算。
    - **服务拆分**：后端将根据功能需求进行服务拆分，例如设计优化服务、运行优化服务等，确保系统可扩展、可维护。

- **计算引擎 (Computation Engine)**
  - **引擎**：Julia
    - **Julia**作为计算引擎，尤其擅长数值计算和优化问题，能够高效地处理复杂的仿真、优化和控制任务。
    - **功能**：负责核心计算，包括正向仿真、容量配置优化、系统优化与控制等。计算任务将通过API被后端调用。
    - **独立部署**：计算引擎模块可以独立部署，确保系统资源的灵活调配和扩展。

- **容器化与调度 (Containerization and Orchestration)**
  - **容器化**：通过Docker进行容器化，确保各个模块可以独立部署和管理。
  - **Kubernetes (K8s)**：使用Kubernetes作为容器编排工具，实现自动化部署、扩容、负载均衡和故障恢复。K8s能够处理大量并发请求，确保系统的高可用性和负载均衡。
    - **微服务架构**：后端服务、计算引擎等会作为独立的微服务进行容器化部署，K8s负责统一调度、监控和管理。

### 功能模块设计

- **设计优化模块 (Design Optimization Module)**
  - **功能**：在设计阶段，通过仿真和优化算法帮助用户进行能源系统的容量配置、系统布局等设计决策。
  - **计算任务**：包括正向仿真、优化设计方案、对比不同设计方案的性能等。
  - **数据接口**：与前端的设计界面进行交互，实时反馈设计方案的结果。

- **运行优化模块 (Operational Optimization Module)**
  - **功能**：在运行阶段，通过数据采集和实时优化控制，确保能源系统的高效运行。主要任务包括系统寻优和调度优化。
  - **计算任务**：包括运行阶段的系统优化、负荷调度、能效提升、控制策略优化等。
  - **数据接口**：与前端进行数据交换，实时展示运行状态和优化结果。

#### **3.4 数据流与交互**

1. **前端与后端交互**：
   - 前端通过Vue.js与后端进行API交互，传输用户输入的设计或运行数据，并展示计算结果。
   - 后端调用计算引擎（Julia）进行复杂的计算任务，然后将结果通过API返回给前端展示。
   
2. **后端与计算引擎交互**：
   - 后端通过API调用Julia计算引擎，传输设计方案或运行数据，计算引擎进行仿真、优化等任务，计算完成后将结果返回。

3. **数据存储与管理**：
   - 数据库（如MySQL、PostgreSQL）用于存储用户数据、优化方案、仿真结果等。
   - 支持数据持久化，用户可以查看历史优化结果、对比不同方案。

### 安全性与性能

- **身份认证与权限管理**：采用JWT（JSON Web Token）进行用户认证与授权，确保系统的安全性。
- **负载均衡**：通过K8s的负载均衡机制确保系统高效运行，避免单点故障。
- **性能优化**：系统会进行性能监控和调优，确保高并发场景下的稳定性与快速响应。

### 桌面程序

为了满足部分用户的离线使用需求，系统还将提供一个桌面客户端，确保用户在没有网络的情况下也能访问和操作相关功能。桌面程序将采用**Tauri**或**Wails**框架进行开发和打包。

1. **Tauri / Wails框架**  
   - **Tauri**：基于Rust和Web技术的轻量级桌面应用开发框架，具有较低的资源消耗和快速的启动速度。
   - **Wails**：提供通过Go语言和Web技术构建跨平台桌面应用的能力，具有良好的性能和灵活性。
   - **功能**：
     - 支持离线使用：用户能够在没有网络的情况下使用设计优化、运行优化等基本功能。
     - 数据同步：一旦网络恢复，桌面客户端会自动与云端同步数据，确保数据的实时性和一致性。

2. **离线运行**  
   - 桌面应用能够在离线环境下进行本地计算和仿真，如优化设计方案、运行数据分析等。
   - 离线模式下的计算引擎将与本地存储的数据进行交互，在恢复联网后会进行数据同步。

3. **跨平台支持**  
   - 采用Tauri或Wails框架打包后的桌面应用能够支持主流操作系统（如Windows、macOS和Linux），为用户提供一致的体验。

### 数据库选择

对于AI4energy项目来说，数据存储是核心环节之一，需要根据业务需求选择合适的数据库。在这个项目中，主要涉及到两类数据库：业务数据库和时序数据库。

1. 业务数据库：PostgreSQL
PostgreSQL作为业务数据库的选择，是由于它在以下方面的优势：

关系型数据管理：PostgreSQL非常适合存储结构化数据，如用户信息、系统配置、优化结果等，可以通过强大的SQL查询功能进行复杂的数据操作。

高并发支持：PostgreSQL具有较强的并发处理能力，适合高并发请求的处理，能确保多用户环境下的数据一致性和高效性。

扩展性：支持水平扩展，能够满足随着业务增长带来的数据量的快速增长，确保系统的可扩展性。

事务处理和数据一致性：支持ACID（原子性、一致性、隔离性、持久性）事务模型，确保数据的安全性与一致性，适用于对数据要求严格的场景。

丰富的扩展功能：

支持全文索引、JSONB数据类型等特性，适应多种复杂的数据存储需求。
插件扩展和自定义函数的支持使得PostgreSQL能够满足不同的业务需求。

2. 时序数据库（待定）
时序数据是能源系统优化中非常重要的一部分，尤其是在运行优化阶段，涉及到大量的时间序列数据（如设备的实时状态、能源消耗、优化结果等）。因此，时序数据库的选择至关重要。

目前的时序数据库有以下几种常见的选择，具体选择可以根据实际需求进一步评估：

InfluxDB

优点：InfluxDB是最常用的时序数据库之一，专为存储和查询时序数据设计，支持高效的数据写入与查询。
特点：具有压缩率高、查询速度快的特点，且能够处理大规模时序数据，适合用于大数据量、高并发的场景。
TimescaleDB

优点：TimescaleDB是基于PostgreSQL构建的时序数据库，能够将PostgreSQL的强大功能与时序数据的高效存储结合起来。
特点：支持与PostgreSQL无缝集成，因此可以利用现有的PostgreSQL技术栈，且支持水平扩展，非常适合需要长期数据存储和复杂查询的场景。
Prometheus

优点：主要用于监控数据的收集与存储，适用于实时指标和时序数据的收集。
特点：在处理短期和高频率的时序数据（如传感器数据、设备运行数据等）时表现优异。

## 已进行过的尝试

### julia+vue前后端分离

使用julia作为后端，vue做前端，前后端分离项目。

https://github.com/ai4energy/WebappExample

### 使用tauri打包桌面程序

https://github.com/ai4energy/julia-vue-desktop-app-example

### 使用wails打包桌面程序
https://github.com/ai4energy/julia-vue-gui-app-wails

### 使用go-zero的能源管理系统草稿

https://github.com/ai4energy/Ai4EEMS-go （私有访问）
https://github.com/ai4energy/ai4e-ems （私有访问）

### 使用oxygen.jl提供web服务

https://github.com/ai4energy/Ai4EJuliaApi.jl

### 未坚持下来的开发者手册

就是想记录如何开发我们的系统的

https://github.com/ai4energy/developer-guide

### 未坚持下来的物联网

https://github.com/ai4energy/ai4e-things

## 其它要补充的说明

### 需要提升代码协作水平，划分权限，正规化
### 需要采用最小可用产品进行开发，明确逐步目标，展开
### 需要筛选合适的拖拉拽编辑底层基础（已部分尝试，可进一步沟通）
### 物联网部分，采用edgex接入，主要做的是能源管理系统。而能源管理系统部分，主要是设备类型、设备、数据，先跑最小版本，而其它的规则、告警等等，慢慢来。部分阅读过iot-dc3、jetlinks，以及一些go的物联网代码。

### edgex部分尝试过device sdk和app sdk。
### 优先实现能源管理平台，空压、空调等系统，急需使用。

### 消息总线需要明确
## 余下的待商量
